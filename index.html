<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Karate Grading Syllabus - Admin</title>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
    }
    header {
      display: flex;
      align-items: center;
      padding: 1rem;
      background-color: #fff;
      border-bottom: 2px solid #ddd;
    }
    header img {
      height: 50px;
      margin-right: 1rem;
    }
    h1 {
      margin: 0;
    }
    .container {
      padding: 2rem;
    }
    select, input[type="text"] {
      padding: 0.5rem;
      font-size: 1rem;
      margin-bottom: 1rem;
      width: 100%;
      max-width: 400px;
      display: block;
    }
    .technique {
      margin-bottom: 0.5rem;
    }
    .technique input {
      margin-right: 0.5rem;
      padding: 0.5rem;
      width: 45%;
    }
    button {
      padding: 0.5rem 1rem;
      margin: 0.5rem 0.5rem 1rem 0;
    }
    footer {
      background-color: red;
      color: white;
      text-align: center;
      padding: 1rem;
      position: fixed;
      bottom: 0;
      width: 100%;
    }
    footer img {
      height: 30px;
      vertical-align: middle;
    }
  </style>
</head>
<body>
  <header>
    <img src="pkr_logo.webp" alt="Logo">
    <h1>Karate Grading Syllabus - Admin</h1>
  </header>
  <div class="container">
    <label>Belt:
      <select id="beltSelect"></select>
    </label>
    <label>Category:
      <select id="categorySelect"></select>
    </label>
    <div id="techniqueList"></div>
    <button onclick="addTechnique()">Add New Technique</button>
    <button onclick="saveChanges()">Save Changes</button>
  </div>
  <footer>
    <span>&copy; 2025 Peninsula Karate</span>
    <img src="pkr_logo.webp" alt="Footer Logo">
  </footer>
  <script>
    // ðŸ”¥ Replace with your actual Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyBP2QUZk25U1gdwWiRZpd4s3EjSX0kt6_0",
      authDomain: "karate-syllabus-7c37c.firebaseapp.com",
      projectId: "karate-syllabus-7c37c",
      storageBucket: "karate-syllabus-7c37c.firebasestorage.app",
      messagingSenderId: "701508561185",
      appId: "1:701508561185:web:57c9383c14cd578be13660"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const belts = ["Red Belt", "Yellow Belt", "Orange Belt", "Green Belt", "Purple Belt", "Blue Belt", "Brown Belt", "Brown/Black Stripe", "Black Belt"];
    const categories = ["Stances", "Punches and Strikes", "Blocks", "Kicks", "Kata", "Basic Drills", "Fighting Drills", "Application / Demonstration / Impact"];

    const beltSelect = document.getElementById('beltSelect');
    const categorySelect = document.getElementById('categorySelect');
    const techniqueList = document.getElementById('techniqueList');
    let currentData = [];

    belts.forEach(belt => {
      let opt = document.createElement('option');
      opt.value = belt;
      opt.textContent = belt;
      beltSelect.appendChild(opt);
    });

    categories.forEach(cat => {
      let opt = document.createElement('option');
      opt.value = cat;
      opt.textContent = cat;
      categorySelect.appendChild(opt);
    });

    beltSelect.onchange = categorySelect.onchange = loadTechniques;

    function loadTechniques() {
      const belt = beltSelect.value;
      const category = categorySelect.value;

      db.collection("syllabus").doc(belt).get().then(doc => {
        const data = doc.data() || {};
        currentData = data[category] || [];

        techniqueList.innerHTML = '';
        currentData.forEach((item, index) => {
          const div = document.createElement('div');
          div.className = 'technique';
          div.innerHTML = `
            <input value="${item[0]}" placeholder="Traditional" onchange="updateItem(${index}, 0, this.value)">
            <input value="${item[1]}" placeholder="Description" onchange="updateItem(${index}, 1, this.value)">
            <button onclick="removeItem(${index})">Delete</button>
          `;
          techniqueList.appendChild(div);
        });
      });
    }

    function updateItem(index, field, value) {
      currentData[index][field] = value;
    }

    function addTechnique() {
      currentData.push(["", ""]);
      loadTechniques();
    }

    function removeItem(index) {
      currentData.splice(index, 1);
      loadTechniques();
    }

    function saveChanges() {
      const belt = beltSelect.value;
      const category = categorySelect.value;

      db.collection("syllabus").doc(belt).set({
        [category]: currentData
      }, { merge: true }).then(() => {
        alert('Saved successfully!');
      });
    }
  </script>
</body>
</html>
